{"ast":null,"code":"import _classCallCheck from\"D:/programming/network.v1/cozy-space-client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"D:/programming/network.v1/cozy-space-client/node_modules/@babel/runtime/helpers/esm/createClass\";var serverAddress=process.env.REACT_APP_URL||'127.0.0.1:3001';export var Posts=/*#__PURE__*/function(){function Posts(){var _this=this;_classCallCheck(this,Posts);this.ws=void 0;this.handleNewPost=void 0;this.ws=new WebSocket(\"wss://\".concat(serverAddress));this.ws.onmessage=function(event){var _this$handleNewPost;(_this$handleNewPost=_this.handleNewPost)===null||_this$handleNewPost===void 0?void 0:_this$handleNewPost.call(_this,JSON.parse(event.data));};}_createClass(Posts,[{key:\"onNewPost\",value:function onNewPost(callback){this.handleNewPost=callback;}},{key:\"getPosts\",value:function getPosts(){return fetch(\"http://\".concat(serverAddress,\"/get_posts\"));}},{key:\"sendPost\",value:function sendPost(post){return fetch(\"http://\".concat(serverAddress,\"/send_post?name=\").concat(post.name,\"&text=\").concat(post.text));}}]);return Posts;}();","map":{"version":3,"sources":["D:/programming/network.v1/cozy-space-client/src/Data.ts"],"names":["serverAddress","process","env","REACT_APP_URL","Posts","ws","handleNewPost","WebSocket","onmessage","event","JSON","parse","data","callback","fetch","post","name","text"],"mappings":"0PAEA,GAAMA,CAAAA,aAAa,CAAGC,OAAO,CAACC,GAAR,CAAYC,aAAZ,EAA6B,gBAAnD,CACA,UAAaC,CAAAA,KAAb,yBAIE,gBAAc,iDAHNC,EAGM,aAFNC,aAEM,QACZ,KAAKD,EAAL,CAAU,GAAIE,CAAAA,SAAJ,iBAAuBP,aAAvB,EAAV,CACA,KAAKK,EAAL,CAAQG,SAAR,CAAoB,SAAAC,KAAK,CAAI,yBAC3B,qBAAA,KAAI,CAACH,aAAL,uEAAA,KAAI,CAAiBI,IAAI,CAACC,KAAL,CAAWF,KAAK,CAACG,IAAjB,CAAjB,CAAJ,CACD,CAFD,CAGD,CATH,2CAWE,mBAAUC,QAAV,CAA8C,CAC5C,KAAKP,aAAL,CAAqBO,QAArB,CACD,CAbH,wBAeE,mBAAW,CACT,MAAOC,CAAAA,KAAK,kBAAWd,aAAX,eAAZ,CACD,CAjBH,wBAkBE,kBAASe,IAAT,CAAqB,CACnB,MAAOD,CAAAA,KAAK,kBAAWd,aAAX,4BAA2Ce,IAAI,CAACC,IAAhD,kBAA6DD,IAAI,CAACE,IAAlE,EAAZ,CACD,CApBH","sourcesContent":["import { FullPost, Post } from './types'\r\n\r\nconst serverAddress = process.env.REACT_APP_URL || '127.0.0.1:3001'\r\nexport class Posts {\r\n  private ws: WebSocket\r\n  private handleNewPost?: (post: FullPost) => void \r\n  \r\n  constructor() {\r\n    this.ws = new WebSocket(`wss://${serverAddress}`)\r\n    this.ws.onmessage = event => { \r\n      this.handleNewPost?.(JSON.parse(event.data))\r\n    }\r\n  }\r\n\r\n  onNewPost(callback: (post: FullPost) => void) {\r\n    this.handleNewPost = callback\r\n  }\r\n\r\n  getPosts() {\r\n    return fetch(`http://${serverAddress}/get_posts`)\r\n  }\r\n  sendPost(post: Post) {\r\n    return fetch(`http://${serverAddress}/send_post?name=${post.name}&text=${post.text}`)\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}